(this.webpackJsonpbattlestrip=this.webpackJsonpbattlestrip||[]).push([[0],{36:function(e,t,n){},37:function(e,t,n){"use strict";n.r(t);var r=n(2),a=n(3),c=n.n(a),o=n(26),s=n.n(o),i=n(10),l=n(40),u=n(13),b=n(15),d=n(6),h=n(41),j=n(7),p=n(39);function f(e,t,n,r){var a=Object(u.a)(Array(t*n).keys()).map((function(e){return{battleStatus:"open",ship:null,index:e}}));return{player:e,shipsAtPort:r.map((function(e){return Object(d.a)({},e)})),shipsAtSea:[],sunkenShips:[],rows:t,columns:n,cells:a}}function O(e,t){return Math.floor(t/e.columns)}function m(e,t,n,r){return"horizontal"===r?Array(t.holes).fill(void 0).map((function(e,t){return n+t})):Array(t.holes).fill(void 0).map((function(t,r){return n+r*e.columns}))}function x(e,t,n,r){var a=m(e,t,n,r);if(a.some((function(t){return t>e.cells.length-1})))return!1;var c=O(e,a[0]);return("horizontal"!==r||!a.some((function(t){return O(e,t)!==c})))&&!a.some((function(t){return e.cells[t].ship}))}function v(e){return e.cells.filter((function(e){return"open"===e.battleStatus}))}function y(e){return"human"===e.turn?"bot":"human"}function S(e,t){switch(t.type){case"ADDBOARD":var n=f(t.player,t.rows,t.columns,t.ships);return Object(d.a)(Object(d.a)({},e),{},{boards:Object(d.a)(Object(d.a)({},e.boards),{},Object(b.a)({},t.player,n))});case"DEPLOYSHIP":var r=e.boards[t.player],a=r.shipsAtPort.find((function(e){return e.id===t.shipId})),c=r.shipsAtPort.filter((function(e){return e.id!==t.shipId})),o=Object(u.a)(r.shipsAtSea);a&&o.push(Object(d.a)(Object(d.a)({},a),{},{anchorCellIndex:t.anchorCellIndex,orientation:t.orientation}));var s=m(r,a,t.anchorCellIndex,t.orientation),i=e.boards[t.player].cells.map((function(e,t){return s.includes(t)?Object(d.a)(Object(d.a)({},e),{},{ship:a.id}):e}));return Object(d.a)(Object(d.a)({},e),{},{boards:Object(d.a)(Object(d.a)({},e.boards),{},Object(b.a)({},t.player,Object(d.a)(Object(d.a)({},r),{},{cells:i,shipsAtPort:c,shipsAtSea:o})))});case"FIRESALVO":var l=e.boards[t.enemy],h=l.cells[t.cellIndex],j=[t.cellIndex],p="miss",O=null,x=Object(u.a)(l.sunkenShips);if(h.ship){O=l.shipsAtSea.find((function(e){return e.id===h.ship}));var v=m(l,O,O.anchorCellIndex,O.orientation).filter((function(e){return e!==t.cellIndex})),S=v.some((function(e){return"open"===l.cells[e].battleStatus}));S||(j=[].concat(Object(u.a)(j),Object(u.a)(v)),x.push(O)),p=S?"hit":"sunk"}var g=l.cells.map((function(e,t){return j.includes(t)?Object(d.a)(Object(d.a)({},e),{},{battleStatus:p}):e}));return Object(d.a)(Object(d.a)({},e),{},{turn:y(e),boards:Object(d.a)(Object(d.a)({},e.boards),{},Object(b.a)({},t.enemy,Object(d.a)(Object(d.a)({},l),{},{cells:g,sunkenShips:x})))});case"ANNIHILATE":var A=e.boards[t.player],I=A.cells.map((function(e){return Object(d.a)(Object(d.a)({},e),{},{battleStatus:e.ship?"sunk":e.battleStatus})})),w=Object(u.a)(A.shipsAtSea);return Object(d.a)(Object(d.a)({},e),{},{boards:Object(d.a)(Object(d.a)({},e.boards),{},Object(b.a)({},t.player,Object(d.a)(Object(d.a)({},A),{},{cells:I,sunkenShips:w})))})}return e}var g=Object(h.a)({id:"game",context:{boards:{},turn:null,winner:null},initial:"intro",states:{intro:{on:{START:"arenaSetup"},meta:{message:"Welcome to Battlestrip!!!"}},arenaSetup:{entry:[Object(j.b)((function(e){return{boards:{},turn:null,winner:null}}))],on:{ADDBOARD:{actions:Object(j.b)((function(e,t){return S(e,t)}))}},always:{target:"deployment",cond:"arenaIsReady"},meta:{message:"Choose a Game"}},deployment:{on:{DEPLOYSHIP:{actions:Object(j.b)((function(e,t){return S(e,t)}))}},always:{target:"gameon",cond:"allShipsDeployed"},meta:{message:"Deploy Your Ships"}},gameon:{entry:[Object(j.b)({turn:function(e){return"human"}})],on:{FIRESALVO:{actions:[Object(j.b)((function(e,t){return S(e,t)}))]},ANNIHILATE:{actions:[Object(j.b)((function(e,t){return S(e,t)}))]}},always:[{target:"gameover",cond:"allShipsSunk"}],meta:{message:"Game On!"}},gameover:{entry:[Object(j.b)({winner:function(e){return function(e){for(var t=Object.keys(e.boards),n=0;n<t.length-1;n++)if(v(e.boards[t[n]]).some((function(e){return e.ship})))return t[n];return null}(e)}})],meta:{message:"Game Over"}}},on:{NEWGAME:"arenaSetup"}},{guards:{arenaIsReady:function(e,t){return 2===Object.keys(e.boards).length},allShipsDeployed:function(e,t){return!Object.keys(e.boards).some((function(t){return 0!==e.boards[t].shipsAtPort.length}))},allShipsSunk:function(e,t){return Object.keys(e.boards).some((function(t){return e.boards[t].sunkenShips.length===e.boards[t].shipsAtSea.length}))}}}),A=Object(p.a)(g);function I(e,t){return Math.floor(Math.random()*(t-e+1)+e)}function w(e){return I(0,e.cells.length)}function C(e,t){for(var n=0;n<10;n++){var r=w(e),a=Math.random()<.5?"horizontal":"vertical";if(x(e,t,r,a))return{anchorIndex:r,orientation:a}}for(var c=0;c<e.cells.length-1;c++){var o="horizontal";if(x(e,t,c,o))return{anchorIndex:c,orientation:o};if(x(e,t,c,o="vertical"))return{anchorIndex:c,orientation:o}}}function N(e){var t=v(e);return t.map((function(e){return e.index}))[I(0,t.length-1)]}A.start();var k=n(25),P=function(e){var t=e.cell,n=e.onCellClick,a=e.onCellHover,c="border-l cell ".concat(n?" cursor-pointer ":""," ").concat(t.ship?" ship ":""),o="open"===t.battleStatus?Object(r.jsx)(k.a,{}):Object(r.jsx)(k.b,{}),s="open"===t.battleStatus?"text-gray-800":["hit","sunk"].includes(t.battleStatus)?"text-red-900":"text-gray-300";return Object(r.jsx)("div",{onClick:function(e){n&&n(e,t)},onMouseEnter:function(e){a&&a(e,t)},onMouseLeave:function(e){a&&a(e,void 0)},children:Object(r.jsx)("div",{className:c,children:Object(r.jsx)("span",{className:s,children:o})})})},E=function(e){var t=e.board,n=e.onCellClick,a=e.onCellHover,c=e.showShips,o=Array(t.rows).fill(0),s=Array(t.columns).fill(0);return Object(r.jsx)("div",{className:"mb-4 flex flex-col border-b border-r bg-blue-800 ".concat(c?" showships ":""),style:{width:"max-content"},children:o.map((function(e,c){return Object(r.jsx)("div",{className:"flex border-t",children:s.map((function(e,o){var s=c*t.columns+o;return Object(r.jsx)(P,{cell:t.cells[s],onCellClick:n,onCellHover:a},s)}))},c)}))})},D=n(23),L=n(28),H=function(e){var t=e.children,n=e.disabled,a=e.className,c=Object(L.a)(e,["children","disabled","className"]),o=n?"cursor-not-allowed text-white opacity-50":"";return Object(r.jsx)("button",Object(d.a)(Object(d.a)({},c),{},{className:"bg-blue-500 text-white active:bg-blue-600 font-thin md:font-bold \n      uppercase text-xs px-2 md:px-4 py-2 rounded shadow hover:shadow-md \n      outline-none focus:outline-none mr-1 mb-1  ".concat(o," ").concat(a),type:"button",style:{transition:"all .15s ease"},children:t}))},M=function(e){var t=e.ship,n=e.orientation,a=Object(u.a)(Array(t.holes).keys()).map((function(e){return{battleStatus:"open",ship:null,index:e}}));return"vertical"===n?Object(r.jsx)("div",{className:"border-b border-r  text-gray-800 ",style:{width:"max-content"},children:a.map((function(e){return Object(r.jsx)("div",{className:"border-t",children:Object(r.jsx)(P,{cell:e})},e.index)}))}):Object(r.jsx)("div",{className:"flex flex-col md:flex-row border-t border-b border-r bg-brown-400 ",style:{width:"max-content"},children:a.map((function(e){return Object(r.jsx)(P,{cell:e},e.index)}))})},R=Object(D.a)((function(e){return{selectedShip:null,setSelectedShip:function(t){return e({selectedShip:t})}}})),F=Object(D.a)((function(e){return{cheating:!1,setCheating:function(t){return e({cheating:t})}}})),Y=function(){var e,t=R(),n=t.selectedShip,c=t.setSelectedShip,o=F(),s=o.cheating,u=o.setCheating,b=Object(l.a)(A),d=Object(i.a)(b,2),h=d[0],j=h.value,p=h.context,f=d[1],O=(null===(e=p.boards.human)||void 0===e?void 0:e.shipsAtPort)||[];return Object(a.useEffect)((function(){"arenaSetup"===j&&u(!1)}),[u,j]),Object(r.jsxs)("div",{className:"w-3/12 md:w-1/12 flex flex-col px-2 py-4 justify-between bg-brown-700",children:[Object(r.jsxs)("div",{className:"flex flex-col",children:[Object(r.jsx)(H,{disabled:["intro","arenaSetup"].includes(j.toString()),onClick:function(){f("NEWGAME")},children:"start over"}),O.map((function(e){var t=e===n?" bg-white opacity-25 text-black ":"";return Object(r.jsxs)("div",{className:"mt-2 ".concat(t),children:[Object(r.jsx)("p",{children:e.id}),Object(r.jsx)("div",{className:"cursor-pointer",onClick:function(){return c(e)},children:Object(r.jsx)(M,{ship:e,orientation:"horizontal"})})]},e.id)}))]}),Object(r.jsxs)("div",{className:"flex flex-col",children:[Object(r.jsx)(H,{disabled:"gameon"!==j,onClick:function(){return f({type:"ANNIHILATE",player:"bot"})},children:"Annihilate"}),Object(r.jsx)(H,{disabled:"gameon"!==j,onClick:function(){return f({type:"ANNIHILATE",player:"human"})},children:"Concede"}),Object(r.jsx)(H,{disabled:"gameon"!==j,onClick:function(){return u(!s)},children:"Cheat"})]})]})},B=function(){var e=Object(l.a)(A),t=Object(i.a)(e,2),n=t[0].context,c=t[1],o=F((function(e){return e.cheating}));Object(a.useEffect)((function(){var e=n.boards.human;"bot"===n.turn&&c({type:"FIRESALVO",player:"bot",enemy:"human",cellIndex:N(e)})}),[n.boards,n.turn,c]);var s;return Object(r.jsxs)("div",{children:[Object(r.jsx)("p",{children:"Bot"}),Object(r.jsx)(E,{board:n.boards.bot,onCellClick:(s="bot",function(e,t){"human"===n.turn&&c({type:"FIRESALVO",player:"human",enemy:s,cellIndex:t.index})}),showShips:o}),Object(r.jsx)("p",{children:"You"}),Object(r.jsx)(E,{board:n.boards.human,showShips:!0})]})},T=[f("human",3,3,[{id:"2-holer",holes:2},{id:"3-holer",holes:3}]),f("human",5,5,[{id:"2-holer",holes:2},{id:"3-holer",holes:3}]),f("human",8,8,[{id:"2-holer",holes:2},{id:"3-holer",holes:3},{id:"4-holer",holes:4}])],z=function(){var e=Object(l.a)(A),t=Object(i.a)(e,2)[1];return Object(r.jsx)("div",{className:"flex flex-col md:flex-row",children:T.map((function(e){return Object(r.jsxs)("div",{className:"mr-4",children:[Object(r.jsx)(E,{board:e,onCellClick:function(){return n=e.rows,r=e.columns,a=e.shipsAtPort,t({type:"ADDBOARD",rows:n,columns:r,player:"human",ships:a}),void t({type:"ADDBOARD",rows:n,columns:r,player:"bot",ships:a});var n,r,a}}),"".concat(e.shipsAtPort.length," ships")]},e.rows)}))})},G=function(){var e=Object(l.a)(A),t=Object(i.a)(e,2),n=t[0],c=n.value,o=n.context,s=t[1],u=R(),b=u.selectedShip,d=u.setSelectedShip,h=Object(a.useState)(!1),j=Object(i.a)(h,2),p=j[0],f=j[1];Object(a.useEffect)((function(){var e=o.boards.bot;if(e.shipsAtPort.length>0){var t=e.shipsAtPort[0],n=C(e,t);n&&s({type:"DEPLOYSHIP",player:"bot",shipId:t.id,anchorCellIndex:n.anchorIndex,orientation:n.orientation})}}),[c,s,o.boards]),Object(a.useEffect)((function(){var e=o.boards.human;if(p&&e.shipsAtPort.length>0){var t=e.shipsAtPort[0],n=C(e,t);n&&s({type:"DEPLOYSHIP",player:e.player,shipId:t.id,anchorCellIndex:n.anchorIndex,orientation:n.orientation})}}),[c,s,o.boards,p]),Object(a.useEffect)((function(){var e=o.boards.human.shipsAtPort;null===b&&e.length>0&&d(e[0])}),[o.boards,b,d]);return Object(r.jsxs)("div",{className:"flex flex-col items-center",children:[Object(r.jsx)(E,{board:o.boards.human,showShips:!0,onCellClick:function(e,t){if(b){var n=e.shiftKey?"vertical":"horizontal";x(o.boards.human,b,t.index,n)&&(s({type:"DEPLOYSHIP",player:"human",shipId:b.id,anchorCellIndex:t.index,orientation:n}),d(null))}}}),Object(r.jsxs)("div",{className:"bg-blue-300 text-blue-800 p-2",children:[Object(r.jsxs)("p",{children:["Click a board grid to place the ",null===b||void 0===b?void 0:b.id]}),Object(r.jsx)("p",{className:"mb-4",children:"Press and hold the Shift key to place the ship vertically."}),Object(r.jsx)(H,{onClick:function(){f(!0)},children:"Or Place My Ships For Me"})]})]})},W=function(e){var t=e.children;return Object(r.jsx)("div",{className:"h-screen pattern",children:t})},V=function(){var e=Object(l.a)(A),t=Object(i.a)(e,1)[0],n=t.value,a=t.meta,c=t.context,o=a["game.".concat(n)];return Object(r.jsxs)("h1",{className:"text-2xl md:text-6xl",children:["gameover"!==n&&o.message,"gameover"===n&&("human"===c.winner?"You Win!!!":"You lose")]})},J=function(){var e=Object(l.a)(A),t=Object(i.a)(e,2)[1];return Object(r.jsxs)("div",{className:"flex flex-col",children:[Object(r.jsx)("h2",{children:"Deploy your ships to sea, then try to sink your opponent's ships before they sink yours!"}),Object(r.jsx)(H,{className:"self-center mt-8",onClick:function(){return t("NEWGAME")},children:"Start"})]})};var K=function(){var e=Object(l.a)(A),t=Object(i.a)(e,1)[0].value;return Object(r.jsx)(W,{children:Object(r.jsxs)("div",{className:"flex flex-row text-gray-300 h-full",children:[Object(r.jsx)(Y,{}),Object(r.jsx)("div",{className:"w-9/12 md:w-11/12 flex  justify-center",children:Object(r.jsxs)("div",{className:"flex flex-col  items-center",children:[Object(r.jsx)(V,{}),"intro"===t&&Object(r.jsx)(J,{}),"arenaSetup"===t&&Object(r.jsx)(z,{}),"deployment"===t&&Object(r.jsx)(G,{}),("gameon"===t||"gameover"===t)&&Object(r.jsx)(B,{})]})})]})})},q=(n(36),function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,42)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,c=t.getLCP,o=t.getTTFB;n(e),r(e),a(e),c(e),o(e)}))});s.a.render(Object(r.jsx)(c.a.StrictMode,{children:Object(r.jsx)(K,{})}),document.getElementById("root")),q()}},[[37,1,2]]]);
//# sourceMappingURL=main.513e3c19.chunk.js.map